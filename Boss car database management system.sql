create database bosscar148;
use bosscar148;
create table owner_detail(owner_id varchar(55) not null, car_owner_name varchar(55),primary key(car_owner_name),car_owner_address varchar(55),city varchar(55),car_owner_emil varchar(55),car_owner_phonenumber varchar(55));
insert owner_detail(owner_id,car_owner_name,car_owner_address,city,car_owner_emil,car_owner_phonenumber) values("ODI001","dinesh","13th cross steert bangaore","bangalore","mail2dinesh4015@gmail.com",9629283040),("ODI002","dina","14th cross steert bangaore","bangalore","mail2dina4015@gmail.com",965629283055),("ODI003","sridhar","5th cross steert chennai","chennai","mail2sridhar@gmail.com",9629283047),("ODI004","murali","16th cross steert mumbai","mumbai","mail2mursli@gmail.com",96292835050),("ODI005","vimal","13th cross steert delhi","delhi","mail3vimal@gmail.com",962927890),("ODI006","arun","67th mailroad bengal","bengal","mail2darun@gmail.com",9640503040),("ODI007","hari","69th main road ranji","ranji","mailhari@gmail.com",9629285060),("ODI008","bala","2nd main road trupathi","trupathy","mail2bala4015@gmail.com",9629285060),("ODI009","dinagaran","18th cross steert chennai","chennai","mail2dinagaran4015@gmail.com",9629284060),("ODI010","raja","45th cross steert bangaore","bangalore","mail2raja401@gmail.com",9629286070),("ODI011","silambhu","2nd mail  road bangaore","bangalore","mail2silambhu@gmail.com",9629284567),("ODI012","ranjitha","7th cross steert mangalore","mangalore","mail2ranjitha4015@gmail.com",9629284567),("ODI013","sachin","3rd main road mohali","mohali","mail2sachin4015@gmail.com",9629285678),("ODI014","ramesh","23rd main road, bangaore","bangalore","mail2dinesh4015@gmail.com",9629283040),("ODI015","ariharan","14th cross steert bangaore","bangalore","mail2ariharan4015@gmail.com",962928457),("ODI016","mani","13th cross steert bangaore","bangalore","mail2mani4015@gmail.com",9629283789),("ODI017","siddu","3rd main road,mumbai","mumbai","mail2siddu4015@gmail.com",9629284567),("ODI018","manju","4th cross steert bangaore","bangalore","mail2manju4015@gmail.com",9629287890),("ODI019","tamil","16th cross steert bangaore","bangalore","mail2tamil4015@gmail.com",9629283989),("ODI020","pooja","17th cross steert bangaore","bangalore","mail2dinesh4015@gmail.com",96296789),("ODI021","niraj","13th cross steert bangaore","bangalore","mail2niraj4015@gmail.com",9629283040),("ODI022","rohit","13th cross steert bangaore","bangalore","mail2dinesh4015@gmail.com",9629283040);
select * from owner_detail;
create table car_detail(car_id varchar(55),
brand varchar(55),vehicle_number varchar(55),car_name varchar(55),car_owner_name varchar(55),foreign key(car_owner_name) references owner_detail(car_owner_name));
insert car_detail(car_id,vehicle_number,brand,car_name,car_owner_name) values("L100100","KA51MK4015","ford","ecosport","dinesh"),("L100101","KA51MK4016","ford","fiesta","dina"),("L100102","KA51MK4017","ford","old figo","sridhar"),("L100103","KA51MK4018","ford","new figo","murali"),("L100104","KA51MK4019","ford","endeour","vimal"),("L100105","KA51MK4020","muruti","suzuki brezza","arun"),("L100106","KA51MK4021","muruti","baleno","hari"),("L100107","KA51MK4022","maruti","maruti dizzer","bala"),("L100108","KA51MK4023","maruti","suzuki ertiga","dinagaran"),("L100109","KA51MK4024","maruti","suzuki jummy","raja"),("L100110","KA51MK4025","maruti","alto","silambhu"),("L100111","KA51MK4026","maruti","ciaz","ranjitha"),("L100112","KA51MK4027","toyota","camry","sachin"),("L100113","KA51MK4028","toyota","fortuner","mani"),("L100114","KA51MK4029","toyota","innova","ariharan"),("L100116","KA51MK4030","ford","ecosport","mani"),("L100117","KA51MK4031","toyota","glanz","siddu"),("L100118","KA51MK4032","hyundai","i20","manju"),("L100119","KA51MK4033","hyundai","kona","tamil"),("L100120","KA51MK4034","hyundai","verna","dinesh");
select *from car_detail;
create table bosscar_branch(branch_id int,branch_name varchar(55),branch_address varchar(55),primary key(branch_id));
insert  bosscar_branch(branch_id,branch_name,branch_address) values(1000,"BG ROAD","OPP IIMB college,bhannerghatta main road,bangalore"),(2000,"KUDLU GATE","hosur main road,kudlugate,bangalore"),(3000,"CK PALYA","vajrahalli,bhannergatta main road,bangalore"),(4000,"MG Road","mg road,bangalore"),(5000,"BTM LAYOUT","btm layout,silkboard,bangalore"),(6000,"HSR layout","hsr layout,bangalore");
select * from bosscar_branch;
create table bosscar_borrower(bosscar_borrowerName varchar(55),primary key(bosscar_borrowerName),bosscar_borrowerAddress varchar(55),bosscar_borrower_city varchar(55),bosscar_borrower_email varchar(55),bosscar_borrowerPhoneNumber bigint);
insert bosscar_borrower(bosscar_borrowerName,bosscar_borrowerAddress,bosscar_borrower_city,bosscar_borrower_email,bosscar_borrowerPhoneNumber)  values("santhosh","1st cross road,bangalore","bangalore","santhosh@gmail.com",8912367890),("manjunath","2nd cross road,bangalore","bangalore","manju@gmail.com",8912367890),("tony","3rd cross road,silkboard","bangalore","tony@gmail.com",8912378908),("karthi","24th main road,mumbai","mumbai","karthi@gmail.com",8912890786),("sanju","2nd cross road,delhi","delhi","santhosh@gmail.com",8912378909),("sanjay","29nd main road,mohali","mohali","sanjay@gmail.com",8912390876),("prthap","3rd cross road,bangalore","bangalore","prathap@gmail.com",8912390780),("kirithi","14th cross road,mangalore","mangalore","kirithi@gmail.com",987037890),("paramaguru","3rd cross road,managalore","mangalore","paramaguru@gmail.com",8912367890),("raja1","21st cross road,chennai","chennai","raja@gmail.com",8912367890),("naruto","3rd main road,bangalore","bangalore","naruto@gmail.com",8982367890),("kalai","3rd cross road,bangalore","bangalore","kalai56@gmail.com",9078367890),("dinesh1","31st cross road,marathahalli","bangalore","dinesh4015@gmail.com",8912367890),("dinesh2","13th cross steert bangaore","bangalore","mail2dinesh4015@gmail.com",9629283040),("dina","14th cross steert bangaore","bangalore","mail2dina4015@gmail.com",9629283055),("sridhar","5th cross steert chennai","chennai","mail2sridhar@gmail.com",9629283047),("murali","16th cross steert mumbai","mumbai","mail2mursli@gmail.com",9629235050),("vimal","13th cross steert delhi","delhi","mail3vimal@gmail.com",962927890),("arun","67th mailroad bengal","bengal","mail2darun@gmail.com",9640503040),("hari","69th main road ranji","ranji","mailhari@gmail.com",9629285060),("bala","2nd main road trupathi","trupathy","mail2bala4015@gmail.com",9629285060),("dinagaran","18th cross steert chennai","chennai","mail2dinagaran4015@gmail.com",9629284060),("raja","45th cross steert bangaore","bangalore","mail2raja401@gmail.com",9629286070),("silambhu","2nd mail  road bangaore","bangalore","mail2silambhu@gmail.com",9629284567),("ranjitha","7th cross steert mangalore","mangalore","mail2ranjitha4015@gmail.com",9629284567),("sachin","3rd main road mohali","mohali","mail2sachin4015@gmail.com",9629285678),("mani1","23rd main road, bangaore","bangalore","mail2dinesh4015@gmail.com",9629283040),("ariharan","14th cross steert bangaore","bangalore","mail2ariharan4015@gmail.com",962928457),("mani","13th cross steert bangaore","bangalore","mail2mani4015@gmail.com",9629283789),("siddu","3rd main road,mumbai","mumbai","mail2siddu4015@gmail.com",9629284567),("manju","4th cross steert bangaore","bangalore","mail2manju4015@gmail.com",9629287890),("tamil","16th cross steert bangaore","bangalore","mail2tamil4015@gmail.com",9629283989),("dinesh","17th cross steert bangaore","bangalore","mail2dinesh4015@gmail.com",96296789),("niraj","13th cross steert bangaore","bangalore","mail2niraj4015@gmail.com",9629283040),("dinesh6","13th cross steert bangaore","bangalore","mail2dinesh4015@gmail.com",9629283040);
select * from bosscar_borrower;
create table available_cars(available_branch_id int,available_branch varchar(55), available_car_name varchar (55));
insert available_cars(available_branch_id,available_branch,available_car_name) values(1000,"BG ROAD","ecosort"),(1000,"BG ROAD","fiesta"),(1000,"BG ROAD","fiesta"),(1000,"BG ROAD","old figo"),(1000,"BG ROAD","new figo"),(2000,"KUDLU GATE","suzuki brezza"),(2000,"KUDLU GATE","baleno"),(2000,"KUDLU GATE","maruti dizzer"),(2000,"KUDLU GATE","suzuki ertiga"),(4000,"MG ROAD","suzuki jummy"),(4000,"MG ROAD","ALTO"),(3000,"CK PALYA","ciaz"),(3000,"CK PALYA","camry"),(3000,"CK PALYA","fotuner"),(5000,"BTM LAYOUT","innova"),(5000,"BTM LAYOUT","ecosport"),(5000,"BTM LAYOUT","glanz"),(6000,"HSR LAYOUT","KONA"),(6000,"HSR LAYOUT","verna");
select * from available_cars;
create table bosscar_car_loan(loan_id int, car_loan_id varchar(55),car_loan_cardNO varchar(55),car_loan_dateOut date,car_loan_dateDueDate  date );
insert bosscar_car_loan(loan_id,car_loan_id,car_loan_cardNO,car_loan_dateOut,car_loan_dateDueDate) values(100,'L100100','CN100',"2023-01-01","2023-02-01"),(101,'L100101','CN101',"2023-01-01","2023-02-01"),(102,'L100102','CN102',"2023-01-01","2023-02-01"),(103,'L100103','CN103',"2023-01-01","2023-02-01"),(104,'L100104','CN104',"2023-01-01","2023-02-01"),(105,'L100105','CN105',"2023-02-01","2023-03-01"),(106,'L100106','CN106',"2023-02-01","2023-03-01"),(107,'L100100','CN100',"2023-02-01","2023-03-01"),(108,'L100108','CN108',"2023-02-01","2023-03-01"),(109,'L100109','CN109',"2023-02-01","2023-03-01"),(110,'L100110','CN110',"2023-02-01","2023-03-01"),(111,'L100111','CN111',"2023-03-01","2023-04-01"),(112,'L100112','CN100',"2023-03-01","2023-04-01"),(113,'L100113','CN113',"2023-03-01","2023-04-01"),(114,'L100114','CN114',"2023-03-01","2023-04-01"),(115,'L100115','CN115',"2023-03-01","2023-04-01"),(116,'L100116','CN116',"2023-02-15","2023-03-01"),(117,'L100117','CN117',"2023-02-15","2023-03-01"),(118,'L100118','CN118',"2023-02-15","2023-03-01"),(119,'L100119','CN119',"2023-02-15","2023-03-01"),(120,'L100120','CN120',"2023-02-15","2023-03-01"),(121,'L100121','CN121',"2023-02-15","2023-03-01"),(122,'L100122','CN122',"2023-02-15","2023-03-01"),("123",'L100123','CN123',"2023-02-15","2023-03-01");
select * from bosscar_car_loan;
create table bosscar_record(record_id int,branch_id int,vehicle_number varchar(55),vehicle_outDate date,vehicle_inDate date,number_ofDays int,borrower_name varchar(55),invoice_amount int,payment_mode varchar(55),payment_status varchar(55));
insert bosscar_record(record_id,branch_id,vehicle_number,vehicle_outDate,vehicle_inDate,number_ofDays,borrower_name,invoice_amount,payment_mode,payment_status)values(200101,1000,"KA51MK4015",'2023-02-01-','2023-02-03',2,"sathosh",2000,"UPI","paid"),(2001012,2000,"KA51MK4065",'2023-02-03','2023-02-01',4,"manjunath",5000,"cash","paid"),(200103,3000,"KA51MK4015",'2023-02-03','2023-02-05',2,"sathosh",2000,"UPI","paid"),(200104,4000,"KA51MK4017",'2023-02-03','2023-02-05',2,"karthi",2000,"cash","paid"),(200105,5000,"KA51MK4018",'2023-02-07','2023-02-08',1,"sanjay",1000,"UPI","paid"),(200106,6000,"KA51MK4019",'2023-02-09','2023-02-14',4,"sathosh",4000,"cash","paid"),(200107,1000,"KA51MK4018",'2023-02-09','2023-02-19',2,"karthi",10000,"UPI","paid"),(200108,2000,"KA51MK4019",'2023-02-15','2023-02-25',10,"karthi",10000,null,"pending"),(200109,3000,"KA51MK4011",'2023-02-20','2023-02-22',2,"sathosh",2000,null,"pending"),(200110,4000,"KA51MK4014",'2023-02-20','2023-02-22',2,"raja",2000,"cash","paid"),(200111,5000,"KA51MK4023",'2023-02-25','2023-03-03',8,"sathosh",8000,"UPI","paid"),(200112,6000,"KA51MK4030",'2023-03-01','2023-03-03',2,"karthi",2000,null,"pending"),(200113,1000,"KA51MK4031",'2023-03-05','2023-02-09',3,"sathosh",3000,"cash","paid"),(200114,2000,"KA51MK4031",'2023-03-10','2023-03-15',5,"sathosh",5000,null,"pending"),(200115,3000,"KA51MK4015",'2023-02-14','2023-03-15',28,"raja",28000,"cash","paid"),(200116,4000,"KA51MK4018",'2023-03-15',null,null,"santhosh",null,null,"pending"),(200117,4000,"KA51MK4018",'2023-03-13',null,null,"santhosh",null,null,"pending"),(200118,4000,"KA51MK4019",'2023-03-15',null,null,"raja",null,null,"pending"),(200119,4000,"KA51MK40131",'2023-03-16',null,null,"manjunath",null,null,"pending"),(200120,3000,"KA51MK4022",'2023-03-15',null,null,"raja",null,null,"pending"),(200121,4000,"KA51MK4030",'2023-02-10','2023-02-13',2,"vimal",2000,"UPI","paid"),(200122,5000,"KA51MK4019",'2023-03-10','2023-03-13',3,"vimal",3000,"cash","paid"),(200123,3000,"KA51MK4027",'2023-02-01','2023-03-10',38,"vimal",38000,"UPI","paid"),(200124,4000,"KA51MK4025",'2023-02-01','2023-02-13',13,"tony",130000,"cash","paid"),(200125,5000,"KA51MK4020",'2023-03-01','2023-03-15',15,"tony",15000,null,"pending"),(200126,6000,"KA51MK4024",'2023-03-01','2023-03-14',14,"tony",14000,null,"pending"),(200127,1000,"KA51MK4022",'2023-02-01','2023-02-05',5,"tony",5000,"cash","paid"),(200128,2000,"KA51MK4025",'2023-02-02','2023-02-23',13,"tony",13000,"cash","paid"),(200129,3000,"KA51MK4030",'2023-03-01','2023-03-15',15,"tony",15000,"cash","paid"),(200130,4000,"KA51MK4025",'2023-02-01','2023-02-05',4,"tony",4000,"UPI","paid"),(200131,4000,"KA51MK4025",'2023-03-02','2023-02-05',3,"raja",3000,null,"pending"),(200132,4000,"KA51MK4025",'2023-03-10','2023-03-13',3,"raja",3000,"UPI","paid"),(200132,5000,"KA51MK4022",'2023-03-14','2023-03-17',2,"upi",2000,null,"pending"),(200134,5000,"KA51MK4021",'2023-02-17','2023-03-28',11,"raja",11000,"cash","paid"),(200135,6000,"KA51MK4024",'2023-03-11','2023-03-13',2,"raja",2000,"cash","paid");
select * from bosscar_record;
select payment_mode,sum(invoice_amount) from bosscar_record group by payment_mode;
select * from owner_detail inner join car_detail on owner_detail.car_owner_name=car_detail.car_owner_name;
select * from bosscar_branch inner join available_cars on bosscar_branch.branch_id=available_cars.available_branch_id; 
select payment_mode,sum(invoice_amount) from bosscar_record group by payment_mode;

select COUNT(bosscar_borrowerName),bosscar_borrower_email,bosscar_borrowerPhoneNumber,bosscar_borrower.bosscar_borrowerName, bosscar_Borrower.bosscar_borrowerAddress from bosscar_record inner join bosscar_borrower on bosscar_record.borrower_name = bosscar_borrower.bosscar_borrowerName group by bosscar_borrower.bosscar_borrowerName, bosscar_borrower.bosscar_borrowerAddress having COUNT(bosscar_borrowerName) >= 3;
select  COUNT(bosscar_borrowerName) from bosscar_borrower;
select  bosscar_branch.branch_name,count(bosscar_branch.branch_id) from  bosscar_branch inner join bosscar_record on bosscar_branch.branch_id=bosscar_record.branch_id group by bosscar_branch.branch_name;
select bosscar_branch.branch_name,bosscar_record.vehicle_number,bosscar_borrower.bosscar_borrowerName,bosscar_borrower.bosscar_borrowerAddress from bosscar_record inner join car_detail on bosscar_record.vehicle_number=car_detail.vehicle_number
                          inner join bosscar_borrower on bosscar_record.borrower_name=bosscar_borrowerName
						  inner join bosscar_branch on bosscar_record.branch_id=bosscar_branch.branch_id where vehicle_inDate is null and bosscar_branch.branch_name="MG Road";
SELECT bosscar_borrower.bosscar_borrowerName from bosscar_borrower where not exists
	(SELECT * FROM bosscar_record
		WHERE bosscar_record.borrower_name = bosscar_borrower.bosscar_borrowerName);
select owner_detail.car_owner_name,owner_detail.car_owner_address,owner_detail.car_owner_phonenumber,car_detail.car_name from owner_detail
						inner join car_detail on owner_detail.car_owner_name = car_detail.car_owner_name where vehicle_number="KA51MK4017";
SELECT count(owner_id),city FROM owner_detail
 group by City;
 SELECT COUNT(owner_detail.owner_id),count(bosscar_borrower.bosscar_borrower_city),owner_detail.city FROM owner_detail inner join bosscar_record on owner_detail.car_number=bosscar_record.car_number  
																				inner join bosscar_borrower on bosscar_record.borrower_name=bosscar_borrower.bosscar_borrowerName			group by City;


		   